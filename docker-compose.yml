services:
  api:
    build: .
    restart: unless-stopped
    network_mode: host
    env_file: .env
    environment:
      - OLLAMA_BASE_URL=http://127.0.0.1:11434
    volumes:
      - /mnt/nvme0n1p1/wellspring:/data
      - /mnt/storage2:/data/documents:ro

  worker:
    build: .
    restart: unless-stopped
    command: ["python", "-m", "wellspring.worker.main"]
    env_file: .env
    environment:
      - OLLAMA_BASE_URL=http://host.docker.internal:11434
    volumes:
      - /mnt/nvme0n1p1/wellspring:/data
    extra_hosts:
      - "host.docker.internal:host-gateway"
