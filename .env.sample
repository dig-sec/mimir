# ── Elasticsearch ─────────────────────────────────────────────
ELASTICSEARCH_HOST=http://127.0.0.1:9200
ELASTICSEARCH_USER=elastic
ELASTICSEARCH_PASSWORD=changeme
ELASTICSEARCH_INDEX_PREFIX=mimir
ELASTICSEARCH_VERIFY_CERTS=1

# ── Ollama LLM ───────────────────────────────────────────────
OLLAMA_BASE_URL=http://127.0.0.1:11434
OLLAMA_MODEL=phi4
MIMIR_API_BASE_URL=
MIMIR_API_TOKEN=
MIMIR_ALLOW_LOCALHOST_WITHOUT_TOKEN=1
MIMIR_EXPOSE_LOCAL_PATHS=0
SEARCH_QUERY_MAX_LENGTH=120

# ── OpenCTI ──────────────────────────────────────────────────
OPENCTI_URL=
OPENCTI_TOKEN=

# ── Elasticsearch source connector (document pull) ───────────
ELASTIC_CONNECTOR_HOSTS=http://127.0.0.1:9200
ELASTIC_CONNECTOR_USER=
ELASTIC_CONNECTOR_PASSWORD=
ELASTIC_CONNECTOR_VERIFY_CERTS=1
ELASTIC_CONNECTOR_INDICES=feedly_news
ELASTIC_CONNECTOR_PAGE_SIZE=200
ELASTIC_CONNECTOR_LOOKBACK_MINUTES=180
ELASTIC_CONNECTOR_MIN_TEXT_CHARS=50
ELASTIC_CONNECTOR_STRIP_HTML=1
ELASTIC_CONNECTOR_NORMALIZE_WHITESPACE=1
ELASTIC_CONNECTOR_TITLE_FIELDS=title,headline,name
ELASTIC_CONNECTOR_TEXT_FIELDS=content,text,summary,description,body,full_text
ELASTIC_CONNECTOR_URL_FIELDS=url,link,origin_url
ELASTIC_CONNECTOR_TIMESTAMP_FIELDS=@timestamp,published,published_at,updated_at,created_at,timestamp

# Compatibility aliases (same connector config, alternate naming)
ELASTICSEARCH_ENABLED=true
ELASTICSEARCH_URL=http://127.0.0.1:9200
ELASTICSEARCH_INDEX=feedly_news
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_VERIFY_TLS=true
ELASTICSEARCH_TIMEOUT=30
ELASTICSEARCH_BATCH_SIZE=500

# ── Ingestion ────────────────────────────────────────────────
WATCHED_FOLDERS=/data/documents
MAX_CHUNKS_PER_RUN=50

# ── Metrics rollup ───────────────────────────────────────────
METRICS_ROLLUP_ENABLED=1
METRICS_ROLLUP_INTERVAL_SECONDS=900
METRICS_ROLLUP_LOOKBACK_DAYS=365
METRICS_ROLLUP_MIN_CONFIDENCE=0.0
METRICS_ROLLUP_STALE_SECONDS=0
CTI_ROLLUP_ENABLED=1
CTI_ROLLUP_LOOKBACK_DAYS=365
CTI_DECAY_HALF_LIFE_DAYS=14
CTI_LEVEL_THRESHOLDS=0.2,0.4,0.6,0.8
CTI_SOURCE_CONFIDENCE_RULES=opencti=0.90,malware=0.88,gvm=0.88,watcher=0.80,feedly=0.78,elasticsearch=0.72,stix=0.75,upload=0.55,file=0.50,unknown=0.45

# ── Logging ──────────────────────────────────────────────────
LOG_LEVEL=INFO

# ── Graph query safety caps (0 = no cap) ─────────────────────
QUERY_MAX_NODES=400
QUERY_MAX_EDGES=1200

# ── Scheduled Sync ───────────────────────────────────────────
# Feedly + OpenCTI auto-pull interval (0 = disabled)
SYNC_INTERVAL_MINUTES=30
# Lookback window per cycle (overlap ensures no gaps)
SYNC_LOOKBACK_MINUTES=60
# Directory shared by workers + API for heartbeat files
WORKER_HEARTBEAT_DIR=/data/worker-heartbeats
# Optional explicit replica ID for heartbeat filenames
# WORKER_HEARTBEAT_INSTANCE=llm-1

# ── Public RSS/Atom threat feeds (no API key/license) ───────
RSS_WORKER_ENABLED=0
RSS_WORKER_INTERVAL_MINUTES=30
RSS_WORKER_FEEDS=https://www.cisa.gov/cybersecurity-advisories/all.xml
RSS_WORKER_LOOKBACK_HOURS=168
RSS_WORKER_MAX_ITEMS_PER_FEED=200
RSS_WORKER_MIN_TEXT_CHARS=80
RSS_WORKER_TIMEOUT_SECONDS=20

# ── Malware worker ───────────────────────────────────────────
MALWARE_WORKER_ENABLED=1
MALWARE_WORKER_INTERVAL_MINUTES=30
MALWARE_WORKER_INDICES=mwdb-openrelik,dailymalwarefeed-*
MALWARE_WORKER_LOOKBACK_MINUTES=180
MALWARE_WORKER_MAX_PER_INDEX=500

# ── GVM / OpenVAS worker ──────────────────────────────────────
GVM_WORKER_ENABLED=0
GVM_WORKER_INTERVAL_MINUTES=30
GVM_WORKER_LOOKBACK_MINUTES=180
GVM_CONNECTION_TYPE=unix
GVM_SOCKET_PATH=/run/gvmd/gvmd.sock
# GVM_HOST=127.0.0.1
# GVM_PORT=9390
GVM_USERNAME=admin
GVM_PASSWORD=admin
GVM_MAX_RESULTS=500
GVM_MIN_QOD=30
GVM_CA_CERT=

# ── Watcher worker ─────────────────────────────────────────────
WATCHER_WORKER_ENABLED=0
WATCHER_WORKER_INTERVAL_MINUTES=30
WATCHER_WORKER_LOOKBACK_MINUTES=180
WATCHER_BASE_URL=http://127.0.0.1:9002
WATCHER_API_TOKEN=
WATCHER_VERIFY_TLS=1
WATCHER_TIMEOUT_SECONDS=30
WATCHER_PAGE_SIZE=200
WATCHER_PULL_TRENDY_WORDS=1
WATCHER_PULL_DATA_LEAKS=1
WATCHER_PULL_DNS_TWISTED=1
WATCHER_PULL_SITE_MONITORING=1
WATCHER_MIN_TRENDY_SCORE=0.0
WATCHER_MIN_TRENDY_OCCURRENCES=1
